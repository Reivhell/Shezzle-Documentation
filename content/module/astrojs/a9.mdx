---
title: "Sesi 9: Images & Assets"
description: "Astro menyediakan komponen `<Image />` dan `<Picture />` untuk optimasi gambar otomatis. Ini adalah salah satu fitur paling powerful untuk performa we..."
category: "astrojs"
tags: ["astrojs"]
order: 9
---

# Sesi 9: Images & Assets

## 9.1 Astro Image Component

Astro menyediakan komponen `<Image />` dan `<Picture />` untuk optimasi gambar otomatis. Ini adalah salah satu fitur paling powerful untuk performa web.

### Analogi Sederhana:

> Bayangkan Astro Image seperti **pabrik fotografi cerdas**. Kamu cukup kirim foto asli, pabrik ini akan otomatis membuat berbagai ukuran (thumbnail, web, print), format modern (WebP, AVIF), dan menyimpannya dengan efisien. Tidak perlu edit manual satu per satu!

### Import dan Penggunaan Dasar:

```astro
---
// src/pages/gallery.astro
import { Image } from 'astro:assets';
import localImage from '../assets/photo.jpg';  // Import lokal
---

<!-- Image lokal dengan optimasi penuh -->
<Image 
  src={localImage}
  alt="Deskripsi gambar yang informatif"
  width={800}
  height={600}
/>

<!-- Image remote (perlu dimensi) -->
<Image 
  src="https://example.com/photo.jpg"
  alt="Remote photo"
  width={800}
  height={600}
  inferSize={true}  <!-- Astro coba infer dimensi -->
/>
```

### Properti Image Component:

| Properti | Tipe | Deskripsi | Wajib |
|----------|------|-----------|-------|
| `src` | `ImageMetadata` atau `string` | Source gambar | Ya |
| `alt` | `string` | Text alternatif untuk accessibility | Ya |
| `width` | `number` | Lebar gambar | Kecuali `inferSize` |
| `height` | `number` | Tinggi gambar | Kecuali `inferSize` |
| `inferSize` | `boolean` | Infer dimensi otomatis | Opsional |
| `quality` | `number` | Kualitas (0-100) | Opsional (default: 80) |
| `format` | `string` | Format output | Opsional (auto) |
| `loading` | `'eager'` atau `'lazy'` | Loading strategy | Opsional (lazy) |
| `decoding` | `'async'` atau `'sync'` | Decoding strategy | Opsional (async) |

---

## 9.2 Image Optimization

Optimasi otomatis yang dilakukan Astro:

### 1. Format Modern:

```astro
---
import { Image } from 'astro:assets';
import photo from '../assets/photo.jpg';
---

<!-- Astro akan konversi ke WebP/AVIF otomatis -->
<Image 
  src={photo}
  alt="Photo"
  width={800}
  height={600}
  format="webp"  <!-- Force WebP -->
/>

<!-- Atau biarkan Astro pilih format terbaik -->
<Image 
  src={photo}
  alt="Photo"
  width={800}
  height={600}
  formats={['avif', 'webp']}  <!-- AVIF untuk browser support, fallback WebP -->
/>
```

### 2. Responsive Images:

```astro
---
import { Image } from 'astro:assets';
import heroImage from '../assets/hero.jpg';
---

<!-- Astro generate multiple sizes untuk srcset -->
<Image 
  src={heroImage}
  alt="Hero"
  widths={[400, 800, 1200, 1600]}  <!-- Generate 4 ukuran -->
  sizes="(max-width: 800px) 100vw, 800px"  <!-- Media query hint -->
/>
```

Output HTML yang dihasilkan:

```html
<img 
  src="/_astro/hero.hash.webp"
  srcset="/_astro/hero.400w.hash.webp 400w,
          /_astro/hero.800w.hash.webp 800w,
          /_astro/hero.1200w.hash.webp 1200w,
          /_astro/hero.1600w.hash.webp 1600w"
  sizes="(max-width: 800px) 100vw, 800px"
  alt="Hero"
  width="800"
  height="600"
  loading="lazy"
  decoding="async"
>
```

### 3. Quality Control:

```astro
---
import { Image } from 'astro:assets';
import thumbnail from '../assets/thumb.jpg';
import banner from '../assets/banner.jpg';
---

<!-- Thumbnail: Kualitas lebih rendah, ukuran kecil -->
<Image 
  src={thumbnail}
  alt="Thumbnail"
  width={200}
  height={150}
  quality={60}
/>

<!-- Banner: Kualitas tinggi -->
<Image 
  src={banner}
  alt="Banner"
  width={1200}
  height={400}
  quality={90}
/>
```

---

## 9.3 Local Images

Gambar dari folder project dengan optimasi penuh.

### Struktur Folder:

```
src/
├── assets/
│   ├── images/
│   │   ├── products/
│   │   │   ├── laptop.jpg
│   │   │   └── mouse.jpg
│   │   ├── team/
│   │   │   ├── budi.jpg
│   │   │   └── ana.jpg
│   │   └── hero-bg.jpg
│   └── icons/
│       └── logo.svg
└── pages/
```

### Penggunaan Local Images:

```astro
---
// src/pages/products.astro
import { Image } from 'astro:assets';
import laptop from '../assets/images/products/laptop.jpg';
import mouse from '../assets/images/products/mouse.jpg';

// Metadata otomatis tersedia
console.log(laptop.width);    // 1200
console.log(laptop.height);   // 800
console.log(laptop.format);   // 'jpg'
console.log(laptop.src);      // '/src/assets/images/products/laptop.jpg'
---

<div class="product-grid">
  <article class="product">
    <Image 
      src={laptop}
      alt="Laptop Pro X1"
      width={600}
      height={400}
    />
    <h3>Laptop Pro X1</h3>
  </article>
  
  <article class="product">
    <Image 
      src={mouse}
      alt="Wireless Mouse"
      width={600}
      height={400}
    />
    <h3>Wireless Mouse</h3>
  </article>
</div>
```

### Gambar di Content Collections:

```typescript
// src/content/config.ts
import { defineCollection, z } from 'astro:content';

const blogCollection = defineCollection({
  type: 'content',
  schema: ({ image }) => z.object({
    coverImage: image(),  // Validasi image reference
    authorAvatar: image().optional(),
  }),
});
```

```markdown
---
title: "Artikel dengan Gambar"
coverImage: ../../assets/images/cover.jpg
authorAvatar: ../../assets/images/author.jpg
---

Konten artikel...
```

```astro
---
// src/pages/blog/[slug].astro
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';

const { post } = Astro.props;
const { Content } = await post.render();
---

<article>
  <Image 
    src={post.data.coverImage}
    alt={post.data.title}
    width={1200}
    height={600}
  />
  
  <div class="author">
    {post.data.authorAvatar && (
      <Image 
        src={post.data.authorAvatar}
        alt="Author"
        width={64}
        height={64}
        class="avatar"
      />
    )}
  </div>
  
  <Content />
</article>
```

---

## 9.4 Remote Images

Gambar dari URL eksternal dengan batasan tertentu.

### Konfigurasi Remote Images:

```javascript
// astro.config.mjs
import { defineConfig } from 'astro/config';

export default defineConfig({
  image: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'cdn.example.com',
        pathname: '/images/**',
      },
      {
        protocol: 'https',
        hostname: '**.unsplash.com',  // Wildcard subdomain
      },
      {
        protocol: 'https',
        hostname: 'images.unsplash.com',
      },
    ],
  },
});
```

### Penggunaan Remote Images:

```astro
---
import { Image } from 'astro:assets';

// Remote image yang diizinkan
const remoteUrl = 'https://cdn.example.com/images/photo.jpg';
---

<!-- WAJIB sertakan dimensi untuk remote images -->
<Image 
  src={remoteUrl}
  alt="Remote photo"
  width={800}
  height={600}
  inferSize={true}  <!-- Coba infer dari header -->
/>

<!-- Atau dengan explicit dimensions -->
<Image 
  src="https://images.unsplash.com/photo-123"
  alt="Unsplash photo"
  width={1200}
  height={800}
/>
```

### Error Handling untuk Remote Images:

```astro
---
import { Image } from 'astro:assets';

let imageUrl = 'https://invalid-url.com/image.jpg';
let imageMetadata = null;

try {
  // Coba fetch metadata
  const response = await fetch(imageUrl, { method: 'HEAD' });
  if (response.ok) {
    imageMetadata = await getImageMetadata(imageUrl);
  }
} catch (error) {
  console.error('Failed to load remote image:', error);
  imageUrl = '/fallback-image.jpg';  // Fallback lokal
}
---

{imageMetadata ? (
  <Image 
    src={imageUrl}
    alt="Content"
    width={imageMetadata.width}
    height={imageMetadata.height}
  />
) : (
  <Image 
    src={import('../assets/fallback.jpg')}
    alt="Fallback"
    width={800}
    height={600}
  />
)}
```

---

## 9.5 Image Formats Support

Astro mendukung berbagai format dengan strategi optimasi berbeda.

### Format Support:

| Format | Input | Output | Keterangan |
|--------|-------|--------|------------|
| JPEG | ✅ | ✅ | Default, good compression |
| PNG | ✅ | ✅ | Transparency, lossless |
| WebP | ✅ | ✅ | Recommended, best compression |
| AVIF | ✅ | ✅ | Next-gen, smallest size |
| GIF | ✅ | ✅ | Animation (limited support) |
| SVG | ✅ | ✅ | Vector, tidak di-transform |
| HEIC | ✅ | ❌ | Apple format, convert ke WebP |

### Format Selection Strategy:

```astro
---
import { Image, Picture } from 'astro:assets';
import photo from '../assets/photo.jpg';
---

<!-- Strategy 1: Format spesifik -->
<Image src={photo} format="webp" alt="WebP only" />

<!-- Strategy 2: Picture element dengan multiple sources -->
<Picture 
  src={photo}
  alt="Responsive format"
  formats={['avif', 'webp', 'jpg']}  <!-- AVIF first, fallback WebP, then JPG -->
  widths={[400, 800, 1200]}
  sizes="(max-width: 800px) 100vw, 800px"
/>
```

Output `<Picture />`:

```html
<picture>
  <source 
    srcset="/_astro/photo.400w.hash.avif 400w,
            /_astro/photo.800w.hash.avif 800w,
            /_astro/photo.1200w.hash.avif 1200w"
    sizes="(max-width: 800px) 100vw, 800px"
    type="image/avif"
  >
  <source 
    srcset="/_astro/photo.400w.hash.webp 400w,
            /_astro/photo.800w.hash.webp 800w,
            /_astro/photo.1200w.hash.webp 1200w"
    sizes="(max-width: 800px) 100vw, 800px"
    type="image/webp"
  >
  <img 
    src="/_astro/photo.hash.jpg"
    srcset="/_astro/photo.400w.hash.jpg 400w,
            /_astro/photo.800w.hash.jpg 800w,
            /_astro/photo.1200w.hash.jpg 1200w"
    sizes="(max-width: 800px) 100vw, 800px"
    alt="Responsive format"
    width="800"
    height="600"
    loading="lazy"
    decoding="async"
  >
</picture>
```

---

## 9.6 Responsive Images

Teknik untuk gambar yang adaptif di berbagai ukuran layar.

### Art Direction dengan Picture:

```astro
---
import { Picture } from 'astro:assets';
import landscape from '../assets/hero-landscape.jpg';
import portrait from '../assets/hero-portrait.jpg';
---

<!-- Different image untuk different viewport -->
<Picture 
  alt="Hero"
  pictureAttributes={{ class: 'hero-picture' }}
>
  <!-- Mobile: Portrait orientation -->
  <source 
    media="(max-width: 768px)"
    srcset={portrait.src}
    width={portrait.width}
    height={portrait.height}
  />
  
  <!-- Desktop: Landscape orientation -->
  <source 
    media="(min-width: 769px)"
    srcset={landscape.src}
    width={landscape.width}
    height={landscape.height}
  />
  
  <!-- Fallback -->
  <img 
    src={landscape.src}
    alt="Hero"
    width={landscape.width}
    height={landscape.height}
  />
</Picture>
```

### Container Queries (Modern):

```astro
---
import { Image } from 'astro:assets';
import photo from '../assets/photo.jpg';
---

<div class="card-container">
  <Image 
    src={photo}
    alt="Responsive"
    widths={[300, 600, 900]}
    sizes="(min-width: 1200px) 25vw, (min-width: 800px) 50vw, 100vw"
    class="responsive-img"
  />
</div>

<style>
  .card-container {
    container-type: inline-size;
    container-name: card;
  }
  
  @container card (min-width: 400px) {
    .responsive-img {
      border-radius: 12px;
    }
  }
</style>
```

### Object Fit dan Position:

```astro
---
import { Image } from 'astro:assets';
import cover from '../assets/cover.jpg';
---

<!-- Cover image dengan object-fit -->
<div class="cover-container">
  <Image 
    src={cover}
    alt="Cover"
    width={1200}
    height={600}
    style={{
      objectFit: 'cover',
      objectPosition: 'center top'
    }}
  />
</div>

<style>
  .cover-container {
    width: 100%;
    height: 400px;
    overflow: hidden;
  }
  
  .cover-container img {
    width: 100%;
    height: 100%;
  }
</style>
```

---

## 9.7 Image Loading Strategies

Strategi loading untuk performa optimal.

### 1. Eager Loading (Critical):

```astro
---
import { Image } from 'astro:assets';
import hero from '../assets/hero.jpg';
import logo from '../assets/logo.svg';
---

<!-- Above fold, critical content -->
<Image 
  src={hero}
  alt="Hero"
  width={1600}
  height={900}
  loading="eager"  <!-- Load segera -->
  fetchpriority="high"  <!-- Priority tinggi -->
/>

<!-- Logo, selalu visible -->
<Image 
  src={logo}
  alt="Logo"
  width={200}
  height={50}
  loading="eager"
/>
```

### 2. Lazy Loading (Default):

```astro
---
import { Image } from 'astro:assets';
import gallery from '../assets/gallery.jpg';
---

<!-- Below fold, load saat scroll -->
<Image 
  src={gallery}
  alt="Gallery"
  width={800}
  height={600}
  loading="lazy"  <!-- Default, bisa dihilangkan -->
  decoding="async"
/>
```

### 3. Progressive Loading (Blur-up):

```astro
---
import { Image } from 'astro:assets';
import photo from '../assets/photo.jpg';
---

<!-- Low Quality Image Placeholder (LQIP) -->
<Image 
  src={photo}
  alt="Photo"
  width={800}
  height={600}
  placeholder="blur"  <!-- Generate blur placeholder -->
  placeholderQuality={10}  <!-- Kualitas placeholder rendah -->
/>
```

### 4. Priority Hints:

```astro
---
import { Image } from 'astro:assets';
import critical from '../assets/critical.jpg';
import important from '../assets/important.jpg';
import normal from '../assets/normal.jpg';
---

<!-- Critical: Load pertama -->
<Image 
  src={critical}
  alt="Critical"
  fetchpriority="high"
  loading="eager"
/>

<!-- Important: Load setelah critical -->
<Image 
  src={important}
  alt="Important"
  fetchpriority="auto"
  loading="eager"
/>

<!-- Normal: Lazy load -->
<Image 
  src={normal}
  alt="Normal"
  fetchpriority="low"
  loading="lazy"
/>
```

### Complete Best Practice Example:

```astro
---
// src/pages/blog/[slug].astro
import { Image, Picture } from 'astro:assets';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<article>
  <!-- Hero image: Critical, eager load -->
  <figure class="hero">
    <Picture 
      src={post.data.coverImage}
      alt={post.data.title}
      widths={[640, 960, 1280, 1920]}
      sizes="100vw"
      formats={['avif', 'webp', 'jpg']}
      loading="eager"
      fetchpriority="high"
      pictureAttributes={{ class: 'hero-picture' }}
    />
    <figcaption>{post.data.coverCaption}</figcaption>
  </figure>
  
  <div class="content">
    <!-- Content images: Lazy load -->
    <Content components={{ img: LazyImage }} />
  </div>
  
  <!-- Related posts thumbnails: Lazy load -->
  <aside class="related">
    {post.data.relatedPosts?.map(related => (
      <Image 
        src={related.data.thumbnail}
        alt={related.data.title}
        width={400}
        height={300}
        loading="lazy"
        decoding="async"
      />
    ))}
  </aside>
</article>

<style>
  .hero {
    margin: 0;
    width: 100%;
  }
  
  .hero-picture img {
    width: 100%;
    height: auto;
    aspect-ratio: 16/9;
    object-fit: cover;
  }
</style>
```

---

## Ringkasan Sesi 9

| Konsep | Fungsi | Best Practice |
|--------|--------|---------------|
| **`<Image />`** | Optimasi gambar otomatis | Gunakan untuk semua gambar lokal |
| **`<Picture />`** | Multiple formats/sizes | Untuk hero images, art direction |
| **Local Images** | Import dari `src/assets/` | Auto-optimasi, type-safe |
| **Remote Images** | URL eksternal | Konfigurasi `remotePatterns`, sertakan dimensi |
| **Responsive** | `widths`, `sizes`, `srcset` | Definisikan `sizes` dengan tepat |
| **Loading** | `eager`, `lazy`, `fetchpriority` | Eager untuk above-fold, lazy untuk rest |
| **Formats** | WebP, AVIF, JPEG | Prioritaskan AVIF > WebP > JPEG |

### Checklist Optimasi Gambar:

- [ ] Gunakan `<Image />` atau `<Picture />` untuk semua gambar
- [ ] Sertakan `alt` text yang deskriptif (accessibility)
- [ ] Definisikan `width` dan `height` (prevent layout shift)
- [ ] Gunakan `loading="lazy"` untuk below-fold images
- [ ] Pilih format modern (WebP/AVIF)
- [ ] Gunakan responsive `sizes` untuk berbagai viewport
- [ ] Implementasikan blur placeholder untuk UX lebih baik

---

**Selanjutnya:** Di Sesi 10, kita akan membahas **Styling & CSS** - scoped styles, CSS modules, Tailwind integration, dan strategi styling modern.
